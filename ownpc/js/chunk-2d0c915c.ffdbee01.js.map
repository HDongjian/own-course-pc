{"version":3,"sources":["webpack:///./src/views/statistics/Summary.vue?688e","webpack:///src/views/statistics/Summary.vue","webpack:///./src/views/statistics/Summary.vue?61cc","webpack:///./src/views/statistics/Summary.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","attrs","query","staticStyle","model","value","callback","$$v","$set","expression","_l","label","key","_v","_s","on","mouthChange","$event","load","slot","exportStudent","studentColumns","stucentData","student","subjectColumns","subject","staticRenderFns","data","getCatch","startTime","endTime","mouth","companyId","studentList","studentType","companyList","subjectType","companyType","title","align","computed","index","push","studentName","hours","obj","count","toFixed","subIndex","subData","subjectName","subObj","total","created","initData","methods","initSearch","$refs","STable","exportCsv","filename","$lib","myMoment","formate","getDateMonthFirst","getDateMonthLast","params","$http","request","method","url","date","component"],"mappings":"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","file":"js/chunk-2d0c915c.ffdbee01.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"summary-container\"},[_c('div',{staticClass:\"tool\"},[_c('Form',{ref:\"query\",attrs:{\"model\":_vm.query,\"inline\":\"\",\"label-width\":80}},[_c('FormItem',{attrs:{\"prop\":\"companyId\",\"label\":\"机构\",\"label-width\":40}},[_c('Select',{staticStyle:{\"width\":\"160px\"},attrs:{\"clearable\":\"\",\"placeholder\":\"机构\"},model:{value:(_vm.query.companyId),callback:function ($$v) {_vm.$set(_vm.query, \"companyId\", $$v)},expression:\"query.companyId\"}},_vm._l((_vm.companyType),function(label,value){return _c('Option',{key:value,attrs:{\"value\":value}},[_vm._v(_vm._s(label))])}),1)],1),_c('FormItem',{attrs:{\"label\":\"月份\",\"prop\":\"mouth\",\"label-width\":40}},[_c('DatePicker',{staticStyle:{\"width\":\"160px\"},attrs:{\"clearable\":\"\",\"editable\":false,\"type\":\"month\",\"placeholder\":\"选择月份\"},on:{\"on-change\":_vm.mouthChange},model:{value:(_vm.query.mouth),callback:function ($$v) {_vm.$set(_vm.query, \"mouth\", $$v)},expression:\"query.mouth\"}})],1),_c('FormItem',{attrs:{\"label-width\":20}},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.load()}}},[_vm._v(\"查询\")])],1)],1)],1),_c('Row',[_c('Col',{attrs:{\"span\":\"11\"}},[_c('Card',[_c('div',{staticClass:\"cl\",staticStyle:{\"height\":\"36px\",\"line-height\":\"36px\"},attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',{staticClass:\"fl\"},[_vm._v(\"学生统计表\")]),_c('Button',{staticClass:\"fr\",attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.exportStudent()}}},[_vm._v(\"导出\")])],1),_c('Table',{ref:\"STable\",attrs:{\"columns\":_vm.studentColumns,\"data\":_vm.stucentData.student}})],1)],1),_c('Col',{attrs:{\"span\":\"11\",\"offset\":\"2\"}},[_c('Card',{attrs:{\"dis-hover\":\"\"}},[_c('div',{staticClass:\"cl\",staticStyle:{\"height\":\"36px\",\"line-height\":\"36px\"},attrs:{\"slot\":\"title\"},slot:\"title\"},[_c('span',{staticClass:\"fl\"},[_vm._v(\"科目统计表\")])]),_c('Table',{attrs:{\"columns\":_vm.subjectColumns,\"data\":_vm.stucentData.subject}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"summary-container\">\r\n    <div class=\"tool\">\r\n      <Form ref=\"query\" :model=\"query\" inline :label-width=\"80\">\r\n        <FormItem prop=\"companyId\" label='机构' :label-width=\"40\">\r\n          <Select clearable style=\"width: 160px\" v-model=\"query.companyId\" placeholder=\"机构\">\r\n            <Option v-for=\"(label,value) in companyType\" :key=\"value\" :value=\"value\">{{label}}</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"月份\" prop=\"mouth\" :label-width=\"40\">\r\n          <DatePicker clearable  @on-change=\"mouthChange\" :editable=\"false\" type=\"month\" placeholder=\"选择月份\" v-model=\"query.mouth\" style=\"width: 160px\"></DatePicker>\r\n        </FormItem>\r\n        <FormItem :label-width=\"20\">\r\n          <Button type=\"primary\" @click=\"load()\">查询</Button>\r\n        </FormItem>\r\n      </Form>\r\n    </div>\r\n    <Row>\r\n      <Col span=\"11\">\r\n        <Card>\r\n          <div slot=\"title\" style=\"height:36px;line-height:36px\" class=\"cl\">\r\n            <span class=\"fl\">学生统计表</span>\r\n            <Button class=\"fr\" type=\"primary\"  @click=\"exportStudent()\">导出</Button>\r\n          <!--eslint-disable-next-line vue/no-parsing-error -->\r\n          </div>\r\n          <Table ref=\"STable\" :columns=\"studentColumns\" :data=\"stucentData.student\"></Table>\r\n        </Card>\r\n      <!--  eslint-disable-next-line vue/no-parsing-error -->\r\n      </Col>\r\n      <Col span=\"11\" offset=\"2\">\r\n        <Card dis-hover>\r\n          <div slot=\"title\" style=\"height:36px;line-height:36px\" class=\"cl\">\r\n            <span class=\"fl\">科目统计表</span>\r\n          <!--eslint-disable-next-line vue/no-parsing-error -->\r\n          </div>\r\n          <Table :columns=\"subjectColumns\" :data=\"stucentData.subject\"></Table>\r\n        </Card>\r\n      <!--  eslint-disable-next-line vue/no-parsing-error -->\r\n      </Col>\r\n    </Row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\r\n  data () {\r\n    return {\r\n      getCatch: true,\r\n      query: {\r\n        startTime: '',\r\n        endTime: '',\r\n        mouth: '',\r\n        companyId: ''\r\n      },\r\n      data: [],\r\n      studentList: [],\r\n      studentType: {},\r\n      companyList: [],\r\n      subjectType: {},\r\n      companyType: {},\r\n      studentColumns: [{\r\n        title: '序号',\r\n        align: 'center',\r\n        key: 'index'\r\n      }, {\r\n        title: '学生姓名',\r\n        align: 'center',\r\n        key: 'studentName'\r\n      }, {\r\n        title: '小时数',\r\n        key: 'hours',\r\n        align: 'center'\r\n      }, {\r\n        title: '课次(1.5小时/次)',\r\n        key: 'count',\r\n        align: 'center'\r\n      }],\r\n      subjectColumns: [{\r\n        title: '序号',\r\n        align: 'center',\r\n        key: 'index'\r\n      }, {\r\n        title: '科目',\r\n        align: 'center',\r\n        key: 'subjectName'\r\n      }, {\r\n        title: '小时数',\r\n        key: 'hours',\r\n        align: 'center'\r\n      }]\r\n    }\r\n  },\r\n  computed: {\r\n    stucentData () {\r\n      let obj = {}\r\n      let subObj = {}\r\n      let data = []\r\n      let subData = []\r\n      let total = 0\r\n      let index = 0\r\n      let subIndex = 0\r\n      for (const c of this.data) {\r\n        let hour = ((new Date(c.endTime).getTime() - new Date(c.startTime).getTime()) / 3600000)\r\n        total += hour\r\n        if (obj[c.studentId]) {\r\n          obj[c.studentId] += hour\r\n        } else {\r\n          obj[c.studentId] = hour\r\n        }\r\n        if (subObj[c.subjectId]) {\r\n          subObj[c.subjectId] += hour\r\n        } else {\r\n          subObj[c.subjectId] = hour\r\n        }\r\n      }\r\n      for (const key in obj) {\r\n        index++\r\n        data.push({\r\n          index,\r\n          studentName: this.studentType[key],\r\n          hours: obj[key],\r\n          count: (obj[key] / 1.5).toFixed(1)\r\n        })\r\n      }\r\n      for (const key in subObj) {\r\n        subIndex++\r\n        subData.push({\r\n          index: subIndex,\r\n          subjectName: this.subjectType[key],\r\n          hours: subObj[key]\r\n        })\r\n      }\r\n      data.push({\r\n        index: '合计',\r\n        studentName: '--',\r\n        hours: total,\r\n        count: (total / 1.5).toFixed(1)\r\n      })\r\n      subData.push({\r\n        index: '合计',\r\n        subjectName: '--',\r\n        hours: total\r\n      })\r\n      return {\r\n        student: data,\r\n        subject: subData\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.initData()\r\n  },\r\n  methods: {\r\n    initData () {\r\n      this.initSearch()\r\n      this.load()\r\n    },\r\n    exportStudent (type) {\r\n      this.$refs.STable.exportCsv({\r\n        filename: `${this.$lib.myMoment(this.query.mouth).formate('YYYY-MM')}课时统计`\r\n      })\r\n    },\r\n    initSearch () {\r\n      this.query.mouth = this.$lib.myMoment().formate('YYYY-MM')\r\n      this.query.startTime = this.$lib.getDateMonthFirst()\r\n      this.query.endTime = this.$lib.getDateMonthLast()\r\n    },\r\n    load () {\r\n      let params = { ...this.query }\r\n      params.startTime = params.startTime ? this.$lib.myMoment(params.startTime).formate('YYYY-MM-DD') + ' 00:00:00' : ''\r\n      params.endTime = params.endTime ? this.$lib.myMoment(params.endTime).formate('YYYY-MM-DD') + ' 23:59:59' : ''\r\n      this.$http.request({\r\n        method: 'get',\r\n        url: `/course/list`,\r\n        params\r\n      }).then((res) => {\r\n        this.data = res.data.data\r\n      })\r\n    },\r\n    mouthChange (mouth) {\r\n      let date = mouth + '-01 00:00:00'\r\n      this.query.startTime = this.$lib.getDateMonthFirst(date)\r\n      this.query.endTime = this.$lib.getDateMonthLast(date)\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./Summary.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./Summary.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Summary.vue?vue&type=template&id=cecc8a58&\"\nimport script from \"./Summary.vue?vue&type=script&lang=js&\"\nexport * from \"./Summary.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}
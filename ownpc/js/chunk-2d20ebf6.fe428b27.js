(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20ebf6"],{b14e:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"role-management"},[r("div",{staticClass:"tool"},[e._e(),r("div",[r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.add()}}},[e._v("添加角色")])],1)],1),r("Table",{attrs:{stripe:"",columns:e.columns,data:e.data}}),r("Modal",{attrs:{title:e.modalTitle},on:{"on-ok":e.modalOk,"on-cancel":e.modalCancel},model:{value:e.modal,callback:function(t){e.modal=t},expression:"modal"}},[r("div",{staticClass:"modal-content"},[r("Form",{ref:"form",attrs:{model:e.form,rules:e.formRules,"label-width":80}},[r("FormItem",{attrs:{label:"角色名称",prop:"roleName"}},[r("Input",{attrs:{maxlength:10},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),r("FormItem",{attrs:{label:"角色描述",prop:"description"}},[r("Input",{attrs:{maxlength:100,type:"textarea",autosize:{minRows:3,maxRows:3}},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),r("FormItem",{attrs:{label:"角色授权",prop:"menuIds"}},[e.showTree?r("Tree",{attrs:{data:e.treeList,"show-checkbox":""},on:{"on-check-change":e.treeChoosed}}):e._e()],1)],1)],1)])],1)},o=[],a=(r("d4d5"),r("7bc1"),r("f301"),r("0eb5"),r("a4c5"),r("f763"),{data:function(){var e=this;return{getCatch:!0,query:{roleName:""},columns:[{title:"序号",type:"index",width:80,align:"center"},{title:"角色姓名",key:"roleName",align:"center"},{title:"角色描述",key:"description",align:"center"},{title:"创建时间",key:"createTime",align:"center",render:function(t,r){return t("p",e.$lib.myMoment(new Date(r.row.createTime)).formate())}},{title:"更新时间",key:"updateTime",align:"center",render:function(t,r){return t("p",e.$lib.myMoment(new Date(r.row.updateTime)).formate())}},{title:"操作",key:"action",width:200,align:"center",render:function(t,r){return t("div",[t("a",{style:{marginRight:"16px"},on:{click:function(){e.edit(r.row)}}},"编辑"),t("a",{on:{click:function(){e.delect(r.row)}}},"删除")])}}],data:[],modal:!1,modalTitle:"添加角色",modifyId:"",form:{roleName:"",menuIds:"",description:""},formRules:{roleName:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],menuIds:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],description:[{required:!0,message:"角色描述不能为空",trigger:"blur"}]},treeList:[],showTree:!0}},created:function(){this.load()},mounted:function(){},methods:{load:function(){var e=this;this.$http.request({method:"get",url:"/role/list"}).then((function(t){e.data=t.data.data}))},reset:function(){},add:function(){this.modal=!0,this.modifyId="",this.modalTitle="添加角色",this.getMenu()},edit:function(e){for(var t in this.modal=!0,this.modifyId=e.roleId,this.modalTitle="编辑".concat(e.roleName),e)this.form.hasOwnProperty(t)&&(this.form[t]=e[t]);this.getMenu()},delect:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"确定要删除".concat(e.roleName,"角色"),onOk:function(){t.$http.request({method:"post",url:"/role/delect/".concat(e.roleId),data:t.form}).then((function(e){200===e.data.code&&(t.load(),t.$Message.success("删除成功"))}))}})},modalOk:function(){var e=this;this.$refs.form.validate((function(t){if(t){var r=e.modifyId?"/role/update/".concat(e.modifyId):"/role/add";e.$http.request({method:"post",url:r,data:e.form}).then((function(t){200===t.data.code&&(e.load(),e.$Message.success(e.modifyId?"编辑成功":"添加成功"),e.modalCancel())}))}}))},modalCancel:function(){this.modal=!1,this.$refs.form.resetFields()},treeChoosed:function(e){var t=[],r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var l=a.value;t.includes(l.menuId)||t.push(l.menuId),0===l.parentId||t.includes(l.parentId)||t.push(l.parentId)}}catch(d){n=!0,o=d}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}this.form.menuIds=t.join(",")},getMenu:function(){var e=this;this.$http.request({method:"get",url:"/menu/list"}).then((function(t){var r=e.form.menuIds.split(","),n=t.data.data.map((function(n){var o=e.hasChildren(t.data.data,n.menuId);return!o&&e.form.menuIds&&r.indexOf(String(n.menuId))>=0&&(n.checked=!0),n.id=n.menuId,n.value=n.menuId,n.title=n.menuName,n}));e.treeList=e.$lib.dealTreeList(n)}))},hasChildren:function(e,t){var r=!0,n=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var l=a.value;if(Number(l.parentId)===Number(t))return!0}}catch(d){n=!0,o=d}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}return!1}}}),i=a,l=r("6691"),d=Object(l["a"])(i,n,o,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d20ebf6.fe428b27.js.map
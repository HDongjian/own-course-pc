{"version":3,"sources":["webpack:///./src/views/system/RoleManagement.vue?cf8d","webpack:///src/views/system/RoleManagement.vue","webpack:///./src/views/system/RoleManagement.vue?d9eb","webpack:///./src/views/system/RoleManagement.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_e","attrs","on","$event","add","_v","columns","data","modalTitle","modalOk","modalCancel","model","value","callback","$$v","modal","expression","ref","form","formRules","$set","minRows","maxRows","treeList","treeChoosed","staticRenderFns","getCatch","query","roleName","modifyId","menuIds","description","showTree","created","load","mounted","methods","$http","request","method","url","reset","getMenu","edit","row","roleId","hasOwnProperty","key","delect","$Modal","confirm","title","content","onOk","res","code","$refs","validate","valid","resetFields","join","h","item","checked","id","menuId","menuName","hasChildren","component"],"mappings":"uHAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAACF,EAAG,MAAM,CAACE,YAAY,QAAQ,CAAojBN,EAAIO,KAAKH,EAAG,MAAM,CAACA,EAAG,SAAS,CAACI,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOV,EAAIW,SAAS,CAACX,EAAIY,GAAG,WAAW,IAAI,GAAGR,EAAG,QAAQ,CAACI,MAAM,CAAC,OAAS,GAAG,QAAUR,EAAIa,QAAQ,KAAOb,EAAIc,QAAQV,EAAG,QAAQ,CAACI,MAAM,CAAC,MAAQR,EAAIe,YAAYN,GAAG,CAAC,QAAQT,EAAIgB,QAAQ,YAAYhB,EAAIiB,aAAaC,MAAM,CAACC,MAAOnB,EAAS,MAAEoB,SAAS,SAAUC,GAAMrB,EAAIsB,MAAMD,GAAKE,WAAW,UAAU,CAACnB,EAAG,MAAM,CAACE,YAAY,iBAAiB,CAACF,EAAG,OAAO,CAACoB,IAAI,OAAOhB,MAAM,CAAC,MAAQR,EAAIyB,KAAK,MAAQzB,EAAI0B,UAAU,cAAc,KAAK,CAACtB,EAAG,WAAW,CAACI,MAAM,CAAC,MAAQ,OAAO,KAAO,aAAa,CAACJ,EAAG,QAAQ,CAACI,MAAM,CAAC,UAAY,IAAIU,MAAM,CAACC,MAAOnB,EAAIyB,KAAa,SAAEL,SAAS,SAAUC,GAAMrB,EAAI2B,KAAK3B,EAAIyB,KAAM,WAAYJ,IAAME,WAAW,oBAAoB,GAAGnB,EAAG,WAAW,CAACI,MAAM,CAAC,MAAQ,OAAO,KAAO,gBAAgB,CAACJ,EAAG,QAAQ,CAACI,MAAM,CAAC,UAAY,IAAI,KAAO,WAAW,SAAW,CAACoB,QAAS,EAAEC,QAAS,IAAIX,MAAM,CAACC,MAAOnB,EAAIyB,KAAgB,YAAEL,SAAS,SAAUC,GAAMrB,EAAI2B,KAAK3B,EAAIyB,KAAM,cAAeJ,IAAME,WAAW,uBAAuB,GAAGnB,EAAG,WAAW,CAACI,MAAM,CAAC,MAAQ,OAAO,KAAO,YAAY,CAAER,EAAY,SAAEI,EAAG,OAAO,CAACI,MAAM,CAAC,KAAOR,EAAI8B,SAAS,gBAAgB,IAAIrB,GAAG,CAAC,kBAAkBT,EAAI+B,eAAe/B,EAAIO,MAAM,IAAI,IAAI,MAAM,IAC55DyB,EAAkB,GCuCtB,G,4DAAA,CAEElB,KAFF,WAEA,WACI,MAAO,CACLmB,UAAU,EACVC,MAAO,CACLC,SAAU,IAEZtB,QAAS,CACf,CACQ,MAAR,KACQ,KAAR,QACQ,MAAR,GACQ,MAAR,UAEA,CACQ,MAAR,OACQ,IAAR,WACQ,MAAR,UAEA,CACQ,MAAR,OACQ,IAAR,cACQ,MAAR,UAEA,CACQ,MAAR,OACQ,IAAR,aACQ,MAAR,SACQ,OAAR,cACU,OAAV,+DAGA,CACQ,MAAR,OACQ,IAAR,aACQ,MAAR,SACQ,OAAR,cACU,OAAV,+DAGA,CACQ,MAAR,KACQ,IAAR,SACQ,MAAR,IACQ,MAAR,SACQ,OAAR,cACU,OAAV,SACA,OACY,MAAZ,CACc,YAAd,QAEY,GAAZ,CACc,MAAd,WACgB,EAAhB,eAGA,MACA,OACY,GAAZ,CACc,MAAd,WACgB,EAAhB,iBAGA,WAKMC,KAAM,GACNQ,OAAO,EACPP,WAAY,OACZqB,SAAU,GACVX,KAAM,CACJU,SAAU,GACVE,QAAS,GACTC,YAAa,IAEfZ,UAAW,CACTS,SAAU,CAClB,CAAU,UAAV,EAAU,QAAV,WAAU,QAAV,SAEQE,QAAS,CACjB,CAAU,UAAV,EAAU,QAAV,WAAU,QAAV,SAEQC,YAAa,CACrB,CAAU,UAAV,EAAU,QAAV,WAAU,QAAV,UAGMR,SAAU,GACVS,UAAU,IAIdC,QA9FF,WA+FIvC,KAAKwC,QAEPC,QAjGF,aAkGEC,QAAS,CACPF,KADJ,WACA,WACMxC,KAAK2C,MAAMC,QAAQ,CACjBC,OAAQ,MACRC,IAAK,eACb,kBACQ,EAAR,qBAGIC,MATJ,aAUIrC,IAVJ,WAWMV,KAAKqB,OAAQ,EACbrB,KAAKmC,SAAW,GAChBnC,KAAKc,WAAa,OAClBd,KAAKgD,WAEPC,KAhBJ,SAgBA,GAIM,IAAK,IAAX,KAHMjD,KAAKqB,OAAQ,EACbrB,KAAKmC,SAAWe,EAAIC,OACpBnD,KAAKc,WAAa,KAAxB,mBACA,EACYd,KAAKwB,KAAK4B,eAAeC,KAC3BrD,KAAKwB,KAAK6B,GAAOH,EAAIG,IAGzBrD,KAAKgD,WAEPM,OA3BJ,SA2BA,cACMtD,KAAKuD,OAAOC,QAAQ,CAClBC,MAAO,KACPC,QAAS,QAAjB,wBACQC,KAAM,WACJ,EAAV,eACYd,OAAQ,OACRC,IAAK,gBAAjB,iBACYjC,KAAM,EAAlB,OACA,kBACkC,MAAlB+C,EAAI/C,KAAKgD,OACX,EAAd,OACc,EAAd,iCAMI9C,QA7CJ,WA6CA,WACMf,KAAK8D,MAAMtC,KAAKuC,UAAS,SAA/B,GACQ,GAAIC,EAAO,CACT,IAAV,4DACU,EAAV,eACYnB,OAAQ,OACRC,IAAKA,EACLjC,KAAM,EAAlB,OACA,kBACkC,MAAlB+C,EAAI/C,KAAKgD,OACX,EAAd,OACc,EAAd,2CACc,EAAd,uBAMI7C,YA/DJ,WAgEMhB,KAAKqB,OAAQ,EACbrB,KAAK8D,MAAMtC,KAAKyC,eAElBnC,YAnEJ,SAmEA,GACM,IAAN,KADA,uBAEA,4EACA,sBACA,iBAEA,wCACA,oBAPA,kFAUM9B,KAAKwB,KAAKY,QAAUA,EAAQ8B,KAAK,MAEnClB,QA/EJ,WA+EA,WACMhD,KAAK2C,MAAMC,QAAQ,CACjBC,OAAQ,MACRC,IAAK,eACb,kBACQ,IAAR,4BACA,+BACU,IAAV,sCAOU,OANKqB,GAAK,EAApB,+CACYC,EAAKC,SAAU,GAEjBD,EAAKE,GAAKF,EAAKG,OACfH,EAAKlD,MAAQkD,EAAKG,OAClBH,EAAKX,MAAQW,EAAKI,SACXJ,KAET,EAAR,oCAGIK,YAlGJ,SAkGA,gCACA,4EACA,kCACA,UAHA,kFAMM,OAAO,MClP8b,I,YCOvcC,EAAY,eACd,EACA5E,EACAiC,GACA,EACA,KACA,KACA,MAIa,aAAA2C,E","file":"js/chunk-2d20ebf6.fe428b27.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"role-management\"},[_c('div',{staticClass:\"tool\"},[(false)?_c('Form',{ref:\"query\",attrs:{\"model\":_vm.query,\"inline\":\"\",\"label-width\":80}},[_c('FormItem',{attrs:{\"prop\":\"user\",\"label\":\"角色姓名\"}},[_c('Input',{attrs:{\"type\":\"text\",\"placeholder\":\"角色姓名\"},model:{value:(_vm.query.roleName),callback:function ($$v) {_vm.$set(_vm.query, \"roleName\", $$v)},expression:\"query.roleName\"}})],1),_c('FormItem',{attrs:{\"label-width\":20}},[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.load()}}},[_vm._v(\"查询\")]),_c('Button',{on:{\"click\":function($event){return _vm.reset()}}},[_vm._v(\"重置\")])],1)],1):_vm._e(),_c('div',[_c('Button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.add()}}},[_vm._v(\"添加角色\")])],1)],1),_c('Table',{attrs:{\"stripe\":\"\",\"columns\":_vm.columns,\"data\":_vm.data}}),_c('Modal',{attrs:{\"title\":_vm.modalTitle},on:{\"on-ok\":_vm.modalOk,\"on-cancel\":_vm.modalCancel},model:{value:(_vm.modal),callback:function ($$v) {_vm.modal=$$v},expression:\"modal\"}},[_c('div',{staticClass:\"modal-content\"},[_c('Form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.formRules,\"label-width\":80}},[_c('FormItem',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}},[_c('Input',{attrs:{\"maxlength\":10},model:{value:(_vm.form.roleName),callback:function ($$v) {_vm.$set(_vm.form, \"roleName\", $$v)},expression:\"form.roleName\"}})],1),_c('FormItem',{attrs:{\"label\":\"角色描述\",\"prop\":\"description\"}},[_c('Input',{attrs:{\"maxlength\":100,\"type\":\"textarea\",\"autosize\":{minRows: 3,maxRows: 3}},model:{value:(_vm.form.description),callback:function ($$v) {_vm.$set(_vm.form, \"description\", $$v)},expression:\"form.description\"}})],1),_c('FormItem',{attrs:{\"label\":\"角色授权\",\"prop\":\"menuIds\"}},[(_vm.showTree)?_c('Tree',{attrs:{\"data\":_vm.treeList,\"show-checkbox\":\"\"},on:{\"on-check-change\":_vm.treeChoosed}}):_vm._e()],1)],1)],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"role-management\">\r\n    <div class=\"tool\">\r\n      <Form v-if=\"false\" ref=\"query\" :model=\"query\" inline :label-width=\"80\">\r\n        <FormItem prop=\"user\" label='角色姓名'>\r\n            <!--eslint-disable-next-line vue/no-parsing-error -->\r\n            <Input type=\"text\" v-model=\"query.roleName\" placeholder=\"角色姓名\"></Input>\r\n        </FormItem>\r\n        <FormItem :label-width=\"20\">\r\n          <Button type=\"primary\" @click=\"load()\">查询</Button>\r\n          <Button @click=\"reset()\">重置</Button>\r\n        </FormItem>\r\n      </Form>\r\n      <div>\r\n        <Button type=\"primary\" @click=\"add()\">添加角色</Button>\r\n      </div>\r\n    </div>\r\n    <Table stripe :columns=\"columns\" :data=\"data\"></Table>\r\n    <!-- <Page v-if=\"query.total>0\" :total=\"query.total\" show-total :page-size=\"query.pageSize\" :current=\"query.pageNum\" @on-change=\"change\"/> -->\r\n    <Modal v-model=\"modal\" :title=\"modalTitle\" @on-ok=\"modalOk\" @on-cancel=\"modalCancel\">\r\n      <div class=\"modal-content\">\r\n        <Form ref=\"form\" :model=\"form\" :rules=\"formRules\" :label-width=\"80\">\r\n          <FormItem label=\"角色名称\" prop=\"roleName\">\r\n            <!--eslint-disable-next-line vue/no-parsing-error -->\r\n            <Input :maxlength=\"10\" v-model=\"form.roleName\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"角色描述\" prop=\"description\">\r\n            <!--eslint-disable-next-line vue/no-parsing-error -->\r\n            <Input :maxlength=\"100\" v-model=\"form.description\" type=\"textarea\" :autosize=\"{minRows: 3,maxRows: 3}\"></Input>\r\n          </FormItem>\r\n          <FormItem label=\"角色授权\" prop=\"menuIds\">\r\n            <Tree v-if=\"showTree\" :data=\"treeList\" @on-check-change=\"treeChoosed\" show-checkbox></Tree>\r\n          </FormItem>\r\n        </Form>\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\r\n  data () {\r\n    return {\r\n      getCatch: true,\r\n      query: {\r\n        roleName: ''\r\n      },\r\n      columns: [\r\n        {\r\n          title: '序号',\r\n          type: 'index',\r\n          width: 80,\r\n          align: 'center'\r\n        },\r\n        {\r\n          title: '角色姓名',\r\n          key: 'roleName',\r\n          align: 'center'\r\n        },\r\n        {\r\n          title: '角色描述',\r\n          key: 'description',\r\n          align: 'center'\r\n        },\r\n        {\r\n          title: '创建时间',\r\n          key: 'createTime',\r\n          align: 'center',\r\n          render: (h, params) => {\r\n            return h('p', this.$lib.myMoment(new Date(params.row.createTime)).formate())\r\n          }\r\n        },\r\n        {\r\n          title: '更新时间',\r\n          key: 'updateTime',\r\n          align: 'center',\r\n          render: (h, params) => {\r\n            return h('p', this.$lib.myMoment(new Date(params.row.updateTime)).formate())\r\n          }\r\n        },\r\n        {\r\n          title: '操作',\r\n          key: 'action',\r\n          width: 200,\r\n          align: 'center',\r\n          render: (h, params) => {\r\n            return h('div', [\r\n              h('a', {\r\n                style: {\r\n                  marginRight: '16px'\r\n                },\r\n                on: {\r\n                  click: () => {\r\n                    this.edit(params.row)\r\n                  }\r\n                }\r\n              }, '编辑'),\r\n              h('a', {\r\n                on: {\r\n                  click: () => {\r\n                    this.delect(params.row)\r\n                  }\r\n                }\r\n              }, '删除')\r\n            ])\r\n          }\r\n        }\r\n      ],\r\n      data: [],\r\n      modal: false,\r\n      modalTitle: '添加角色',\r\n      modifyId: '',\r\n      form: {\r\n        roleName: '',\r\n        menuIds: '',\r\n        description: ''\r\n      },\r\n      formRules: {\r\n        roleName: [\r\n          { required: true, message: '角色名称不能为空', trigger: 'blur' }\r\n        ],\r\n        menuIds: [\r\n          { required: true, message: '菜单名称不能为空', trigger: 'blur' }\r\n        ],\r\n        description: [\r\n          { required: true, message: '角色描述不能为空', trigger: 'blur' }\r\n        ]\r\n      },\r\n      treeList: [],\r\n      showTree: true\r\n    }\r\n  },\r\n\r\n  created () {\r\n    this.load()\r\n  },\r\n  mounted () {},\r\n  methods: {\r\n    load () {\r\n      this.$http.request({\r\n        method: 'get',\r\n        url: `/role/list`\r\n      }).then((res) => {\r\n        this.data = res.data.data\r\n      })\r\n    },\r\n    reset () {},\r\n    add () {\r\n      this.modal = true\r\n      this.modifyId = ''\r\n      this.modalTitle = '添加角色'\r\n      this.getMenu()\r\n    },\r\n    edit (row) {\r\n      this.modal = true\r\n      this.modifyId = row.roleId\r\n      this.modalTitle = `编辑${row.roleName}`\r\n      for (const key in row) {\r\n        if (this.form.hasOwnProperty(key)) {\r\n          this.form[key] = row[key]\r\n        }\r\n      }\r\n      this.getMenu()\r\n    },\r\n    delect (data) {\r\n      this.$Modal.confirm({\r\n        title: '提示',\r\n        content: `确定要删除${data.roleName}角色`,\r\n        onOk: () => {\r\n          this.$http.request({\r\n            method: 'post',\r\n            url: `/role/delect/${data.roleId}`,\r\n            data: this.form\r\n          }).then((res) => {\r\n            if (res.data.code === 200) {\r\n              this.load()\r\n              this.$Message.success('删除成功')\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    modalOk () {\r\n      this.$refs.form.validate((valid) => {\r\n        if (valid) {\r\n          let url = this.modifyId ? `/role/update/${this.modifyId}` : `/role/add`\r\n          this.$http.request({\r\n            method: 'post',\r\n            url: url,\r\n            data: this.form\r\n          }).then((res) => {\r\n            if (res.data.code === 200) {\r\n              this.load()\r\n              this.$Message.success(this.modifyId ? '编辑成功' : '添加成功')\r\n              this.modalCancel()\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    modalCancel () {\r\n      this.modal = false\r\n      this.$refs.form.resetFields()\r\n    },\r\n    treeChoosed (ids) {\r\n      let menuIds = []\r\n      for (const d of ids) {\r\n        if (!menuIds.includes(d.menuId)) {\r\n          menuIds.push(d.menuId)\r\n        }\r\n        if (d.parentId !== 0 && !menuIds.includes(d.parentId)) {\r\n          menuIds.push(d.parentId)\r\n        }\r\n      }\r\n      this.form.menuIds = menuIds.join(',')\r\n    },\r\n    getMenu () {\r\n      this.$http.request({\r\n        method: 'get',\r\n        url: `/menu/list`\r\n      }).then((res) => {\r\n        let menuIds = this.form.menuIds.split(',')\r\n        let data = res.data.data.map(item => {\r\n          let h = this.hasChildren(res.data.data, item.menuId)\r\n          if (!h && this.form.menuIds && menuIds.indexOf(String(item.menuId)) >= 0) {\r\n            item.checked = true\r\n          }\r\n          item.id = item.menuId\r\n          item.value = item.menuId\r\n          item.title = item.menuName\r\n          return item\r\n        })\r\n        this.treeList = this.$lib.dealTreeList(data)\r\n      })\r\n    },\r\n    hasChildren (menus, id) {\r\n      for (const menu of menus) {\r\n        if (Number(menu.parentId) === Number(id)) {\r\n          return true\r\n        }\r\n      }\r\n      return false\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./RoleManagement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../../node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/index.js??vue-loader-options!./RoleManagement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./RoleManagement.vue?vue&type=template&id=5ca92804&\"\nimport script from \"./RoleManagement.vue?vue&type=script&lang=js&\"\nexport * from \"./RoleManagement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/_vue-loader@15.7.1@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}